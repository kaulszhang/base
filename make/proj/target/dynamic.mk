
ifneq ($(PLATFORM_CRTBEGIN_DYNAMIC),)
	PLATFORM_CRTBEGIN_DYNAMIC	:= $(wildcard $(addsuffix /$(PLATFORM_CRTBEGIN_DYNAMIC),$(PLATFORM_LIBRARY_DIRECTORYS)))
endif

ifneq ($(PLATFORM_CRTEND_DYNAMIC),)
	PLATFORM_CRTEND_DYNAMIC		:= $(wildcard $(addsuffix /$(PLATFORM_CRTEND_DYNAMIC),$(PLATFORM_LIBRARY_DIRECTORYS)))
endif

LINK_FLAGS		:= $(LINK_FLAGS) -shared -Wl,-soname=$(TARGET_FILE)

ifeq ($(DYNAMIC_NAME_SUFFIX),.dll)
	LINK_FLAGS		:= $(LINK_FLAGS) -Wl,--out-implib,$(TARGET_FILE:$(DYNAMIC_NAME_PREFIX)%.dll=$(TARGET_DIRECTORY)/$(STATIC_NAME_PREFIX)%.dll.a)
endif

$(TARGET_FILE_FULL): $(SOURCE_OBJECTS) $(DEPEND_FILES) $(MAKEFILE_LIST)
	@$(RM) $@
	LD_LIBRARY_PATH=$(LIB_PATHS2) $(LD) $(LINK_FLAGS) $(PLATFORM_CRTBEGIN_DYNAMIC) $(SOURCE_OBJECTS_FULL) $(LINK_LIB_PATHS) $(LINK_LIB_NAMES) $(PLATFORM_CRTEND_DYNAMIC) -o $@
